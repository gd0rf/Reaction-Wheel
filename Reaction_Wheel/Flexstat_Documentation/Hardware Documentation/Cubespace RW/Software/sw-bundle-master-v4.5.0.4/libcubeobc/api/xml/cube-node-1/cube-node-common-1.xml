<?xml version="1.0" encoding="utf-8"?>
<NodeDefinition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <IsModule>true</IsModule>
  <Name>cube-node-common</Name>
  <CodeName>CubeNodeCommon</CodeName>
  <InterfaceVersion>1</InterfaceVersion>
  <CanLog>false</CanLog>

  <!-- ****************** HOUSEKEEPING ****************** -->

  <Ttcs CanSet="false" CanGet="true" CodeName="HealthTlm" DisplayName="Health Telemetry" Description="HealthTelemetry for CubeNode" Len="26" PartOfStartItem="0" PartOfNumItems="0" Group="HousekeepingTelemetry">
    <Item CodeName="McuCurrent"         DisplayName="MCU Current"             Description="MCU current"                                                     BitOffset="0"   BitLength="16" ValueType="UnsignedInteger" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="mA" RangeMin="0" RangeMax="0" />
    <Item CodeName="McuTemp"            DisplayName="MCU Temperature"         Description="MCU temperature in deg C"                                        BitOffset="16"  BitLength="16" ValueType="SignedInteger" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="deg C" RangeMin="0" RangeMax="0" />
    <Item CodeName="McuVoltage"         DisplayName="MCU Voltage"             Description="MCU supply voltage"                                              BitOffset="32"  BitLength="16" ValueType="UnsignedInteger" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="mV" RangeMin="0" RangeMax="5000" />
    <Item CodeName="PmuCurrent"         DisplayName="PMU Current"             Description="Current measurement from PMU (if applicable)"                    BitOffset="48"  BitLength="16"  ValueType="UnsignedInteger" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="mA" RangeMin="0" RangeMax="0" />
    <Item CodeName="PmuCurrentValid"    DisplayName="PMU Current Valid"       Description="Flag indicating that the PMU current measurement is valid"       BitOffset="64"  BitLength="1"  ValueType="Boolean" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
    <Item CodeName="PowerGood"          DisplayName="Power Good"              Description="PowerGood signal (from PMU for CQ / Always true for CNo)"        BitOffset="65"  BitLength="1"  ValueType="Boolean" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
    <Item CodeName="Reserved"           DisplayName=""                        Description=""                                                                BitOffset="66"  BitLength="6"  ValueType="Reserved" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
    <Item CodeName="PortCurrent"        DisplayName="Port Current"            Description="Port 5v Currents"                                                BitOffset="72"  BitLength="96" ValueType="Struct" StructName="PortCurrent" Iterator="Ports" />
    <Item CodeName="WatchdogCount"      DisplayName="Watchdog Counters"       Description="Bitmask representing virtual watchdog region warning counters."  BitOffset="168" BitLength="40" ValueType="ByteArray"   EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
  </Ttcs>

  <Ttcs CanSet="false" CanGet="true" CodeName="NodeModel" DisplayName="CubeNode Model" Description="CubeNode Model" Len="1" PartOfStartItem="0" PartOfNumItems="0" Group="CubeNode">
    <Item CodeName="Model" DisplayName="Model" Description="CubeNode Model" BitOffset="0" BitLength="8" ValueType="Enumeration" EnumerationName="NodeModelEnum" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
  </Ttcs>

  <Ttcs CanSet="true" CanGet="true" CodeName="PowerSwitchState" DisplayName="5V Power Switch State" Description="Enable/Disable 5V Power Switch Downstream" Len="4" PartOfStartItem="0" PartOfNumItems="0" Group="CubeNode">
    <Item CodeName="Power"        DisplayName="Power State"            Description="Power State on port"           BitOffset="0"   BitLength="32" ValueType="Struct" StructName="PowerSwState" Iterator="Ports" />
  </Ttcs>

  <!-- ****************** STRUCTS ****************** -->

  <Struct CodeName="PortCurrent" Description="Port current data" Len="3">
    <Item CodeName="vBattCurrent"      DisplayName="VBatt 5V current"       Description="VBatt 5V Current Monitor current"        BitOffset="0"   BitLength="16"  ValueType="UnsignedInteger" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="mA" RangeMin="0" RangeMax="0" />
    <Item CodeName="vBattOvercurrent"  DisplayName="VBatt 5V overcurrent"   Description="VBatt 5V Overcurrent flag (max 500mA)"   BitOffset="16"  BitLength="1"   ValueType="Boolean" EnumerationName="" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="mA" RangeMin="0" RangeMax="0" />
  </Struct>

  <Struct CodeName="PowerSwState" Description="Power switch state" Len="1">
    <Item CodeName="Power"  DisplayName="Power Switch State"   Description="Power Switch State"   BitOffset="0"   BitLength="8" ValueType="Enumeration" EnumerationName="SwitchState" CalibrationUserToRaw="" CalibrationRawToUser="" MeasurementUnit="" RangeMin="0" RangeMax="0" />
  </Struct>

  <!-- ****************** ENUMERATIONS ****************** -->

  <Enum>
    <CodeName>SwitchState</CodeName>
    <EnumValue NumericalValue="0" CodeName="Off"  DisplayName="Off" Description="Switch is disabled" />
    <EnumValue NumericalValue="1" CodeName="On"   DisplayName="On"  Description="Switch is enabled" />
  </Enum>

  <Enum>
    <CodeName>NodeModelEnum</CodeName>
    <EnumValue NumericalValue="0" CodeName="Model1"  DisplayName="Model 1" Description="CubeNode Model 1" />
    <EnumValue NumericalValue="1" CodeName="Model2"  DisplayName="Model 2" Description="CubeNode Model 2" />
    <EnumValue NumericalValue="2" CodeName="Model3"  DisplayName="Model 3" Description="CubeNode Model 3" />
  </Enum>

  <!-- !!! common-component ID's should start from the high-end (127 TC & 254 TLM) and decrement !!! -->

	<!-- TC -->
	<TtcIds TtcName="PowerSwitchState"  GetId="255" SetId="127" LogId="0" />

  <!-- TLM -->
  <TtcIds TtcName="HealthTlm"         GetId="254" SetId="255" LogId="0" />
  <TtcIds TtcName="PowerSwitchState"  GetId="253" SetId="255" LogId="0" />
  <TtcIds TtcName="NodeModel"         GetId="252" SetId="255" LogId="0" />

  <!-- ****************** TYPES MODULES ****************** -->
	<TypesModules>
    <string>cube-node-1/cube-node-common-types-1.xml</string>
	</TypesModules>

</NodeDefinition>
